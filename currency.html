<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OxygenOS Converter Fix</title>
    <style>
        :root {
            --bg-color: #000000;
            --card-color: #1c1c1c;
            --accent-color: #ff9f0a;
            --text-main: #ffffff;
            --text-dim: #888888;
        }

        /* Prevent scrolling and bouncing on mobile */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            background-color: var(--bg-color);
            color: white;
            font-family: -apple-system, sans-serif;
            overflow: hidden;
        }

        .app-container {
            display: flex;
            flex-direction: column;
            height: 100dvh; /* Dynamic height adapts to mobile browser bars */
            padding: 16px;
            max-width: 500px;
            margin: 0 auto;
        }

        /* Selection Overlay */
        #selector-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-color);
            z-index: 100;
            display: none;
            flex-direction: column;
        }

        .overlay-header { padding: 20px; border-bottom: 1px solid #333; }
        #search-input {
            width: 100%; padding: 12px; background: #222; border: 1px solid #444;
            border-radius: 10px; color: white; margin-top: 10px; font-size: 16px;
        }

        /* Top Display (Flexible space) */
        .display-area {
            flex: 1; /* Takes up all available space above the keypad */
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 8px;
        }

        .card {
            background: var(--card-color);
            padding: 18px;
            border-radius: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .currency-code { font-weight: bold; font-size: 20px; }
        .currency-name { color: var(--text-dim); font-size: 13px; }
        .value { font-size: 34px; color: var(--accent-color); font-weight: 300; }

        .middle-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 4px 12px;
        }

        .swap-btn {
            background: #222; border: none; color: var(--accent-color);
            width: 44px; height: 44px; border-radius: 50%; font-size: 20px;
        }

        /* Keypad (Fixed at bottom) */
        .keypad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            padding-bottom: env(safe-area-inset-bottom); /* Fix for iPhone home bar */
            margin-top: 10px;
        }

        .key {
            height: clamp(60px, 12vh, 80px); /* Adjusts height based on screen size */
            border: none;
            background: transparent;
            color: white;
            font-size: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .key:active { background: #333; }
        .orange { color: var(--accent-color); }
        .red { color: #ff453a; font-size: 18px; font-weight: bold; }

    </style>
</head>
<body>

<div class="app-container">
    <div id="selector-overlay">
        <div class="overlay-header">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <span style="font-weight:bold;">Select Currency</span>
                <span onclick="closeSelector()" style="color:var(--accent-color); cursor:pointer;">Cancel</span>
            </div>
            <input type="text" id="search-input" placeholder="Search..." onkeyup="filterCurrencies()">
        </div>
        <div id="list-container" style="overflow-y:auto; flex:1;"></div>
    </div>

    <div class="display-area">
        <div class="card" onclick="openSelector('from')">
            <div>
                <div class="currency-code" id="from-code">USD</div>
                <div class="currency-name" id="from-name">US Dollar</div>
            </div>
            <div class="value" id="input-val">1</div>
        </div>

        <div class="middle-bar">
            <span style="color:var(--text-dim); font-size:12px;">Live Updates Active</span>
            <button class="swap-btn" onclick="swap()">⇅</button>
        </div>

        <div class="card" onclick="openSelector('to')">
            <div>
                <div class="currency-code" id="to-code">DZD</div>
                <div class="currency-name" id="to-name">Algerian Dinar</div>
            </div>
            <div class="value" id="output-val">...</div>
        </div>
    </div>

    <div class="keypad">
        <button class="key" onclick="press('1')">1</button>
        <button class="key" onclick="press('2')">2</button>
        <button class="key" onclick="press('3')">3</button>
        <button class="key" onclick="press('4')">4</button>
        <button class="key" onclick="press('5')">5</button>
        <button class="key" onclick="press('6')">6</button>
        <button class="key" onclick="press('7')">7</button>
        <button class="key" onclick="press('8')">8</button>
        <button class="key" onclick="press('9')">9</button>
        <button class="key orange" onclick="press('.')">.</button>
        <button class="key" onclick="press('0')">0</button>
        <button class="key red" onclick="backspace()">⌫</button>
        <button class="key red" onclick="clearAll()" style="grid-column: span 3; height: 50px;">ALL CLEAR</button>
    </div>
</div>

<script>
    const API_KEY = "3c6b319dee5a556cf5c84d16";
    const currencyData = {"DZD":"Algerian Dinar","ARS":"Argentine Peso","AUD":"Australian Dollar","BHD":"Bahrain Dinar","BYN":"Belarus Ruble","BRL":"Brazilian Real","BND":"Brunei Ringgit","BGN":"Bulgarian Lev","KHR":"Cambodian Riel","CAD":"Canadian Dollar","CLP":"Chilean Peso","CNY":"Chinese Yuan","COP":"Colombian Peso","CRC":"Costa Rican Colon","CZK":"Czech Crown","DKK":"Danish Krone","EGP":"Egyptian Pound","EUR":"Euro","HKD":"Hong Kong Dollar","HUF":"Hungarian Forint","ISK":"Icelandic Krona","INR":"Indian Rupee","IDR":"Indonesian Rupiah","IRR":"Iranian Rial","IQD":"Iraqi Dinar","ILS":"Israel New Shekel","JPY":"Japanese Yen","JOD":"Jordanian Dinar","KZT":"Kazakhstani Tenge","KES":"Kenya Shilling","KWD":"Kuwaiti Dinar","MMK":"Kyat","LAK":"Lao Kip","LBP":"Lebanese Pound","MOP":"Macau Pataca","MYR":"Malaysian Ringgit","MXN":"Mexican Peso","MDL":"Moldovan Leu","MAD":"Moroccan Dirham","NGN":"Naira","NPR":"Nepalese Rupee","TWD":"New Taiwan dollar","NZD":"New Zealand Dollar","NOK":"Norwegian Krone","OMR":"Omani Rial","PKR":"Pakistani Rupee","PHP":"Philippine Peso","PLN":"Polish Zloty","GBP":"Pound Sterling","QAR":"Qatari Riyal","RON":"Romanian Leu","RUB":"Russian Ruble","SAR":"Saudi Riyal","SGD":"Singapore Dollar","ZAR":"South African Rand","LKR":"Sri Lanka Rupee","SEK":"Swedish Krona","CHF":"Swiss Franc","SYP":"Syrian Pound","BDT":"Taka","TZS":"Tanzania Shilling","THB":"Thai Baht","TND":"Tunisian Dinar","TRY":"Turkish Lira","AED":"UAE Dirham","UGX":"Uganda Shilling","UAH":"Ukrainian Hryvnia","USD":"US Dollar","UZS":"Uzbekistani Som","VND":"Vietnamese Dong","KRW":"Won","ZMW":"Zambian Kwacha"};

    let from="USD", to="DZD", rate=1, input="1", targetSide='from';

    async function fetchRate() {
        try {
            const res = await fetch(`https://v6.exchangerate-api.com/v6/${API_KEY}/pair/${from}/${to}`);
            const data = await res.json();
            if(data.result==="success") { rate = data.conversion_rate; updateUI(); }
        } catch(e) {}
    }

    function updateUI() {
        document.getElementById('input-val').innerText = input;
        const result = (parseFloat(input) * rate).toLocaleString(undefined, { maximumFractionDigits: 2 });
        document.getElementById('output-val').innerText = result;
        document.getElementById('from-code').innerText = from;
        document.getElementById('from-name').innerText = currencyData[from];
        document.getElementById('to-code').innerText = to;
        document.getElementById('to-name').innerText = currencyData[to];
    }

    function press(k) {
        if(input==="0" && k!==".") input=k;
        else if(!(k==="." && input.includes("."))) { if(input.length<10) input+=k; }
        updateUI();
    }

    function backspace() { input = input.slice(0,-1) || "0"; updateUI(); }
    function clearAll() { input="0"; updateUI(); }
    function swap() { [from,to]=[to,from]; fetchRate(); }

    function openSelector(side) {
        targetSide = side;
        document.getElementById('selector-overlay').style.display="flex";
        filterCurrencies();
    }

    function filterCurrencies() {
        const query = document.getElementById('search-input').value.toLowerCase();
        const container = document.getElementById('list-container');
        container.innerHTML = "";
        Object.keys(currencyData).forEach(code => {
            if(code.toLowerCase().includes(query) || currencyData[code].toLowerCase().includes(query)) {
                const div = document.createElement('div');
                div.style.padding = "18px 20px";
                div.style.borderBottom = "1px solid #1a1a1a";
                div.innerHTML = `<span>${currencyData[code]}</span> <strong style="float:right; color:var(--accent-color)">${code}</strong>`;
                div.onclick = () => { if(targetSide==='from') from=code; else to=code; closeSelector(); fetchRate(); };
                container.appendChild(div);
            }
        });
    }

    function closeSelector() { document.getElementById('selector-overlay').style.display="none"; }
    fetchRate();
</script>
</body>
</html>